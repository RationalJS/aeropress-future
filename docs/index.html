
    
<!doctype html>
<meta charset=utf8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel=stylesheet href='./styles.css'>
<script defer src='./script.js'></script>
<title>Home</title>
<body>
<script>window.relativeToRoot="./"</script>
<script defer src="./block-script.js"></script>
<div id='error-message'>
  ⚠️ Oops! This page doesn't appear to define a <span>type</span> called <code>_</code>.
</div>

    
    <div class='container'>
    
    <div class='sidebar-wrapper'>
    <div class='sidebar-expander'>Show navigation</div>
    <div class='sidebar'>
      <a href="./search.html" style="display: block; padding: 0 8px;">Search</a>
      
      <div class='docs-listing'><a href="./index.html">Home</a></div>
      <div class='toc-header'>Page Contents</div>
      <div class='table-of-contents'>
      <a href="#the-future-is-now" class='level-1 header'>The Future is Now</a>
<a href="#installation" class='level-2 header'>Installation</a>
<a href="#basic-usage" class='level-2 header'>Basic Usage</a>
<a href="#api" class='level-2 header'>API</a>
<a href="#belt.result" class='level-3 header'>Belt.Result</a>
<a href="#futurejs" class='level-3 header'>FutureJs</a>
<a href="#todo" class='level-2 header'>TODO</a>
<a href="#build" class='level-2 header'>Build</a>
<a href="#build---watch" class='level-2 header'>Build + Watch</a>
<a href="#test" class='level-2 header'>Test</a>
<a href="#editor" class='level-2 header'>Editor</a>
      </div>
      <div class='project-title'>Package modules</div><div class='project-listing'><a href="./api/Future.html">Future</a>
<a href="./api/FutureJs.html">FutureJs</a>
<a href="./api/FutureResult.html">FutureResult</a>
<a href="./api/Future.html">Future</a>
<a href="./api/FutureJs.html">FutureJs</a>
<a href="./api/FutureResult.html">FutureResult</a></div>
    </div>
    </div>
  
    <div class='main'>
    <a href="https://github.com/rationaljs/future/blob/master/README.md" class="edit-link">Edit</a>
    <p><a href="https://www.npmjs.com/package/reason-future" target="_blank" rel="noopener nofollow" title="" class="external-link"><img src='https://img.shields.io/npm/v/reason-future.svg' alt='npm' /></a>
<a href="https://travis-ci.org/RationalJS/future" target="_blank" rel="noopener nofollow" title="" class="external-link"><img src='https://travis-ci.org/RationalJS/future.svg?branch=master' alt='Build Status' /></a></p>
<a href="#the-future-is-now" id="the-future-is-now"><h1>The Future is Now</h1></a>

<p>Future is a <code>Js.Promise</code> alternative. It is written in ReasonML.</p>
<p>Compared to a promise, a future is:</p>
<ul><li><strong>Lighter weight</strong> – Only ~25 lines of implementation.</li><li><strong>Simpler</strong> – Futures only resolve to a single type (as opposed to resolve and reject types), giving you more flexibility on your error handling.</li><li><strong>More rubust</strong> – Futures have sound typing (unlike JS promises).</li></ul>

<a href="#installation" id="installation"><h2>Installation</h2></a>

<p>First make sure you have bs-platform <code>&gt;= 3.1.0</code>. Then install with npm:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='5' id='block-5'><code>$ npm install --save reason-future</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='5-alt' id='block-5-alt'><code>This code was skipped</code></pre>
  
  
  
</div>

<p>Then add <code>&quot;reason-future&quot;</code> to your <code>bsconfig.json</code> dev dependencies:</p>
<pre class='code-txt json'><code class='json'>{
  ...
  &quot;bs-dependencies&quot;: [
    &quot;reason-future&quot;
  ]
}</code></pre>

<a href="#basic-usage" id="basic-usage"><h2>Basic Usage</h2></a>

<p>To create a task, use <code>Future.make</code>. It provides a single <code>resolve</code> function, like a promise with no <code>reject</code>:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='4' id='block-4'><code>let <span class='pattern-ident' data-type="Future.t(string)">futureGreeting</span> = <span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span>(<span class='pattern-ident' data-type="string => unit">resolve</span> =&gt; <span class='ident' data-type="string => unit">resolve</span>(<span class='string' data-type="string">&quot;hi&quot;</span>));</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='4-alt' id='block-4-alt'><code>[@@@ocaml.ppx.context { cookies = [] }]
let <span class='pattern-ident' data-type="Future.t(string)">futureGreeting</span> =
  <span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span> (fun <span class='pattern-ident' data-type="string => unit">resolve</span>  -&gt; <span class='ident' data-type="string => unit">resolve</span> ((&quot;hi&quot;)[@reason.raw_literal &quot;hi&quot;]))</code></pre>
  
  
  
</div>

<p>To get the value of a future, use <code>Future.get</code>:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='3' id='block-3'><code>let <span class='pattern-ident' data-type="Future.t(string)">futureGreeting</span> = <span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span>(<span class='pattern-ident' data-type="string => unit">resolve</span> =&gt; <span class='ident' data-type="string => unit">resolve</span>(<span class='string' data-type="string">&quot;hi&quot;</span>));
<span class='ident' data-type="Future.t(string)">futureGreeting</span>
|. <span class='ident' data-type="(Future.t(string), string => unit) => unit">Future.get</span>(<span class='pattern-ident' data-type="string">x</span> =&gt; <span class='ident' data-type="string => unit">Js.log</span>(<span class='string' data-type="string">&quot;Got value: &quot;</span> <span class='operator' data-type="(string, string) => string">++</span> <span class='ident' data-type="string">x</span>));

/* Alternatively: */

<span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span>(<span class='pattern-ident' data-type="string => unit">resolve</span> =&gt; <span class='ident' data-type="string => unit">resolve</span>(<span class='string' data-type="string">&quot;hi&quot;</span>))
|. <span class='ident' data-type="(Future.t(string), string => unit) => unit">Future.get</span>(<span class='pattern-ident' data-type="string">x</span> =&gt; <span class='ident' data-type="string => unit">Js.log</span>(<span class='string' data-type="string">&quot;Got value: &quot;</span> <span class='operator' data-type="(string, string) => string">++</span> <span class='ident' data-type="string">x</span>));</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='3-alt' id='block-3-alt'><code>[@@@ocaml.ppx.context { cookies = [] }]
let <span class='pattern-ident' data-type="Future.t(string)">futureGreeting</span> =
  <span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span> (fun <span class='pattern-ident' data-type="string => unit">resolve</span>  -&gt; <span class='ident' data-type="string => unit">resolve</span> ((&quot;hi&quot;)[@reason.raw_literal &quot;hi&quot;]))
let _ =
  <span class='ident' data-type="Future.t(string)">futureGreeting</span> |.
    (<span class='ident' data-type="(Future.t(string), string => unit) => unit">Future.get</span>
       (fun <span class='pattern-ident' data-type="string">x</span>  -&gt;
          <span class='ident' data-type="string => unit">Js.log</span> (((&quot;Got value: &quot;)[@reason.raw_literal &quot;Got value: &quot;]) <span class='operator' data-type="(string, string) => string">^</span> <span class='ident' data-type="string">x</span>)))
let _ =
  (<span class='ident' data-type="string => unit => unit => Future.t(string)">Future.make</span> (fun <span class='pattern-ident' data-type="string => unit">resolve</span>  -&gt; <span class='ident' data-type="string => unit">resolve</span> ((&quot;hi&quot;)[@reason.raw_literal &quot;hi&quot;])))
    |.
    (<span class='ident' data-type="(Future.t(string), string => unit) => unit">Future.get</span>
       (fun <span class='pattern-ident' data-type="string">x</span>  -&gt;
          <span class='ident' data-type="string => unit">Js.log</span> (((&quot;Got value: &quot;)[@reason.raw_literal &quot;Got value: &quot;]) <span class='operator' data-type="(string, string) => string">^</span> <span class='ident' data-type="string">x</span>)))</code></pre>
  
  
  
</div>

<p><code>Future.get</code> only <em>retrieves</em> the future value. If you want to <strong>transform</strong> it to a <em>different</em> value, then you should use <code>Future.map</code>:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='2' id='block-2'><code>/* Shortcut for: let future_A = Future.make(resolve =&gt; resolve(99)); */
let <span class='pattern-ident' data-type="Future.t(int)">future_A</span> = <span class='ident' data-type="int => Future.t(int)">Future.value</span>(<span class='int' data-type="int">99</span>);

let <span class='pattern-ident' data-type="Future.t(int)">future_B</span> = <span class='ident' data-type="Future.t(int)">future_A</span> |. <span class='ident' data-type="(Future.t(int), int => int) => Future.t(int)">Future.map</span>(<span class='pattern-ident' data-type="int">n</span> =&gt; <span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">1</span>);


<span class='ident' data-type="Future.t(int)">future_A</span>
|. <span class='ident' data-type="(Future.t(int), int => unit) => unit">Future.get</span>(<span class='pattern-ident' data-type="int">n</span> =&gt; <span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="int">n</span>)); /* logs: 99 */

<span class='ident' data-type="Future.t(int)">future_B</span>
|. <span class='ident' data-type="(Future.t(int), int => unit) => unit">Future.get</span>(<span class='pattern-ident' data-type="int">n</span> =&gt; <span class='ident' data-type="int => unit">Js.log</span>(<span class='ident' data-type="int">n</span>)); /* logs: 100 */</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='2-alt' id='block-2-alt'><code>[@@@ocaml.ppx.context { cookies = [] }]
let <span class='pattern-ident' data-type="Future.t(int)">future_A</span> = <span class='ident' data-type="int => Future.t(int)">Future.value</span> <span class='int' data-type="int">99</span>
let <span class='pattern-ident' data-type="Future.t(int)">future_B</span> = <span class='ident' data-type="Future.t(int)">future_A</span> |. (<span class='ident' data-type="(Future.t(int), int => int) => Future.t(int)">Future.map</span> (fun <span class='pattern-ident' data-type="int">n</span>  -&gt; <span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">1</span>))
let _ = <span class='ident' data-type="Future.t(int)">future_A</span> |. (<span class='ident' data-type="(Future.t(int), int => unit) => unit">Future.get</span> (fun <span class='pattern-ident' data-type="int">n</span>  -&gt; <span class='ident' data-type="int => unit">Js.log</span> <span class='ident' data-type="int">n</span>))
let _ = <span class='ident' data-type="Future.t(int)">future_B</span> |. (<span class='ident' data-type="(Future.t(int), int => unit) => unit">Future.get</span> (fun <span class='pattern-ident' data-type="int">n</span>  -&gt; <span class='ident' data-type="int => unit">Js.log</span> <span class='ident' data-type="int">n</span>))</code></pre>
  
  
  
</div>

<p>And finally, if you <code>map</code> a future and return <strong>another</strong> future, you probably want to <code>flatMap</code> instead:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='1' id='block-1'><code>let <span class='pattern-ident' data-type="Future.t(int)">futureNum</span> = <span class='ident' data-type="int => Future.t(int)">Future.value</span>(<span class='int' data-type="int">50</span>);

let <span class='pattern-ident' data-type="Future.t(Future.t(int))">ft_a</span> = <span class='ident' data-type="Future.t(int)">futureNum</span> |. <span class='ident' data-type="(Future.t(int), int => Future.t(int)) => Future.t(
  Future.t(int)
)">Future.map</span>(<span class='pattern-ident' data-type="int">n</span> =&gt; <span class='ident' data-type="int => Future.t(int)">Future.value</span>(<span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">10</span>));
let <span class='pattern-ident' data-type="Future.t(int)">ft_b</span> = <span class='ident' data-type="Future.t(int)">futureNum</span> |. <span class='ident' data-type="(Future.t(int), int => Future.t(int)) => Future.t(int)">Future.flatMap</span>(<span class='pattern-ident' data-type="int">n</span> =&gt; <span class='ident' data-type="int => Future.t(int)">Future.value</span>(<span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">20</span>));

/* ft_a has type future(future(int)) – probably not what you want. */
/* ft_b has type future(int) */</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='1-alt' id='block-1-alt'><code>[@@@ocaml.ppx.context { cookies = [] }]
let <span class='pattern-ident' data-type="Future.t(int)">futureNum</span> = <span class='ident' data-type="int => Future.t(int)">Future.value</span> <span class='int' data-type="int">50</span>
let <span class='pattern-ident' data-type="Future.t(Future.t(int))">ft_a</span> = <span class='ident' data-type="Future.t(int)">futureNum</span> |. (<span class='ident' data-type="(Future.t(int), int => Future.t(int)) => Future.t(
  Future.t(int)
)">Future.map</span> (fun <span class='pattern-ident' data-type="int">n</span>  -&gt; <span class='ident' data-type="int => Future.t(int)">Future.value</span> (<span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">10</span>)))
let <span class='pattern-ident' data-type="Future.t(int)">ft_b</span> = <span class='ident' data-type="Future.t(int)">futureNum</span> |. (<span class='ident' data-type="(Future.t(int), int => Future.t(int)) => Future.t(int)">Future.flatMap</span> (fun <span class='pattern-ident' data-type="int">n</span>  -&gt; <span class='ident' data-type="int => Future.t(int)">Future.value</span> (<span class='ident' data-type="int">n</span> <span class='operator' data-type="(int, int) => int">+</span> <span class='int' data-type="int">20</span>)))</code></pre>
  
  
  
</div>

<a href="#api" id="api"><h2>API</h2></a>

<p>Core functions. <strong>Note:</strong> <code>_</code> represents the future itself as inserted by <code>|.</code> (the <a href="https://bucklescript.github.io/docs/en/fast-pipe.html" target="_blank" rel="noopener nofollow" title="" class="external-link">fast pipe</a> operator).</p>
<ul><li><code>Future.make(resolver)</code> - Create a new, potentially-async future.</li><li><code>Future.value(x)</code> - Create a new future with a plain value (synchronous).</li><li><code>Future.map(_,fn)</code> - Transform a future value into another value</li><li><code>Future.flatMap(_,fn)</code> - Transform a future value into another future value</li><li><code>Future.get(_,fn)</code> - Get the value of a future</li><li><code>Future.tap(_,fn)</code> - Do something with the value of a future without changing it. Returns the same future so you can continue using it in a pipeline. Convenient for side effects such as console logging.</li></ul>

<a href="#belt.result" id="belt.result"><h3>Belt.Result</h3></a>

<p>Convenience functions when working with a future <code>Belt.Result</code>. <strong>Note:</strong> <code>_</code> represents the future itself as inserted by <code>|.</code> (the <a href="https://bucklescript.github.io/docs/en/fast-pipe.html" target="_blank" rel="noopener nofollow" title="" class="external-link">fast pipe</a> operator).</p>
<p><strong>Note 2</strong>: The terms <code>Result.Ok</code> and <code>Result.Error</code> in this context are expected to be read as <code>Belt.Result.Ok</code> and <code>Belt.Result.Error</code>.</p>
<ul><li><code>Future.mapOk(_,fn)</code> - Transform a future value into another value, but only if the value is an <code>Result.Ok</code>. Similar to <code>Promise.prototype.then</code></li><li><code>Future.mapError(_,fn)</code> - Transform a future value into another value, but only if the value is an <code>Result.Error</code>. Similar to <code>Promise.prototype.catch</code></li><li><code>Future.tapOk(_,fn)</code> - Do something with the value of a future without changing it, but only if the value is a <code>Belt.Result.Ok</code>. Returns the same future. Convenience for side effects such as console logging.</li><li><code>Future.tapError(_,fn)</code> - Same as <code>tapOk</code> but for <code>Result.Error</code></li></ul>

<p>The following are more situational:</p>
<ul><li><code>Future.flatMapOk(_, fn)</code> - Transform a future <code>Result.Ok</code> into
a future <code>Result</code>. Flattens the inner future.</li><li><code>Future.flatMapError(_, fn)</code> - Transform a future <code>Result.Error</code> into
a future <code>Result</code>. Flattens the inner future.</li></ul>

<a href="#futurejs" id="futurejs"><h3>FutureJs</h3></a>

<p>Convenience functions for interop with JavaScript land.</p>
<ul><li><code>FutureJs.fromPromise(promise, errorTransformer)</code><ul><li><code>promise</code> is the <code>Js.Promise.t(&#39;a)</code> that will be transformed into a
 <code>Future</code></li><li><code>errorTransformer</code> allows you to determine how <code>Js.Promise.error</code>
 objects will be transformed before they are returned wrapped within
 a <code>Belt.Result.Error</code>.  This allows you to implement the error handling
 method which best meets your application&#39;s needs.</li></ul></li></ul>

<p>Example use:</p>
<div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='0' id='block-0'><code>/*
  This error handler is super simple; you will probably want
  to write something more sophisticated in your app.
*/
let <span class='pattern-ident' data-type="'a => Js.String.t">handleError</span> = <span class='ident' data-type="'a => Js.String.t">Js.String.make</span>;

<span class='ident' data-type="string => Js.Promise.t(string)">Js.Promise.resolve</span>(<span class='string' data-type="string">&quot;some value&quot;</span>)
|. <span class='ident' data-type="(
  Js.Promise.t(string),
  Js.Promise.error => Js.String.t
) => Future.t(Belt.Result.t(string, Js.String.t))">FutureJs.fromPromise</span>(<span class='ident' data-type="Js.Promise.error => Js.String.t">handleError</span>)
|. <span class='ident' data-type="(
  Future.t(Belt.Result.t(string, Js.String.t)),
  string => unit
) => Future.t(Belt.Result.t(unit, Js.String.t))">Future.mapOk</span>(<span class='pattern-ident' data-type="string">value</span> =&gt; <span class='ident' data-type="(string, string) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;It worked!&quot;</span>, <span class='ident' data-type="string">value</span>))
|. <span class='ident' data-type="(
  Future.t(Belt.Result.t(unit, Js.String.t)),
  Js.String.t => unit
) => Future.t(Belt.Result.t(unit, unit))">Future.mapError</span>(<span class='pattern-ident' data-type="Js.String.t">err</span> =&gt; <span class='ident' data-type="(string, Js.String.t) => unit">Js.log2</span>(<span class='string' data-type="string">&quot;uh on&quot;</span>, <span class='ident' data-type="Js.String.t">err</span>));</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='0-alt' id='block-0-alt'><code>[@@@ocaml.ppx.context { cookies = [] }]
let <span class='pattern-ident' data-type="'a => Js.String.t">handleError</span> = <span class='ident' data-type="'a => Js.String.t">Js.String.make</span>
let _ =
  (((<span class='ident' data-type="string => Js.Promise.t(string)">Js.Promise.resolve</span> ((&quot;some value&quot;)[@reason.raw_literal &quot;some value&quot;]))
      |. (<span class='ident' data-type="(
  Js.Promise.t(string),
  Js.Promise.error => Js.String.t
) => Future.t(Belt.Result.t(string, Js.String.t))">FutureJs.fromPromise</span> <span class='ident' data-type="Js.Promise.error => Js.String.t">handleError</span>))
     |.
     (<span class='ident' data-type="(
  Future.t(Belt.Result.t(string, Js.String.t)),
  string => unit
) => Future.t(Belt.Result.t(unit, Js.String.t))">Future.mapOk</span>
        (fun <span class='pattern-ident' data-type="string">value</span>  -&gt;
           <span class='ident' data-type="(string, string) => unit">Js.log2</span> ((&quot;It worked!&quot;)[@reason.raw_literal &quot;It worked!&quot;]) <span class='ident' data-type="string">value</span>)))
    |.
    (<span class='ident' data-type="(
  Future.t(Belt.Result.t(unit, Js.String.t)),
  Js.String.t => unit
) => Future.t(Belt.Result.t(unit, unit))">Future.mapError</span>
       (fun <span class='pattern-ident' data-type="Js.String.t">err</span>  -&gt; <span class='ident' data-type="(string, Js.String.t) => unit">Js.log2</span> ((&quot;uh on&quot;)[@reason.raw_literal &quot;uh on&quot;]) <span class='ident' data-type="Js.String.t">err</span>))</code></pre>
  
  
  
</div>

<p>See <a href="http://keleshev.com/composable-error-handling-in-ocaml" target="_blank" rel="noopener nofollow" title="" class="external-link">Composible Error Handling in OCaml</a> for several strategies that you may employ.</p>
<a href="#todo" id="todo"><h2>TODO</h2></a>

<ul><li>[ ] Implement cancellation tokens</li><li>[x] Interop with <code>Js.Promise</code></li><li>[x] <code>flatMapOk</code> / <code>flatMapError</code> (with <a href="http://keleshev.com/composable-error-handling-in-ocaml" target="_blank" rel="noopener nofollow" title="" class="external-link">composable error handling</a>)</li></ul>

<a href="#build" id="build"><h2>Build</h2></a>

<pre class='code-txt sh'><code class='sh'>npm run build</code></pre>

<a href="#build---watch" id="build---watch"><h2>Build + Watch</h2></a>

<pre class='code-txt sh'><code class='sh'>npm run start</code></pre>

<a href="#test" id="test"><h2>Test</h2></a>

<pre class='code-txt sh'><code class='sh'>npm test</code></pre>

<a href="#editor" id="editor"><h2>Editor</h2></a><p>If you use <code>vscode</code>, Press <code>Windows + Shift + B</code> it will build automatically</p>

    </div>
    <div class='right-blank'></div>
    </div>
  